# OpenJoey — Codebase Scan: Have / Delete / Keep / Update / Add

Scanned against the [OpenJoey Reduction & Execution Plan](openjoey-reduction-execution-plan.md). **Deep scan:** file counts and paths verified. Use this as the concrete list for what to delete, keep, update, or add.

---

## 1. WHAT WE ALREADY HAVE (aligned with plan)

| Area                                    | What exists                                                                                                                                                                                                                                                                                 | Notes                                                                                                                                                                                                                                                                                                                                                                                                      |
| --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **OpenJoey core**                       | `src/openjoey/` (**25 files**)                                                                                                                                                                                                                                                              | gateway-hook, onboarding, session-isolation, skill-guard, tier-middleware, Supabase client, broadcast, **daily-brief**, **trade-news-feeds**, callback-handler, referral system, lifecycle, cache (Redis, reply-cache), keyboard-builder, token-extract, marketing-hooks, database.types                                                                                                                   |
| **Telegram**                            | `src/telegram/` (88 files)                                                                                                                                                                                                                                                                  | Bot, message dispatch, native commands, handlers, message context — primary channel in use                                                                                                                                                                                                                                                                                                                 |
| **Discord**                             | `src/discord/` (67 files)                                                                                                                                                                                                                                                                   | Core Discord delivery                                                                                                                                                                                                                                                                                                                                                                                      |
| **Web**                                 | `src/web/` (78 files)                                                                                                                                                                                                                                                                       | Web dashboard / inbound                                                                                                                                                                                                                                                                                                                                                                                    |
| **WhatsApp**                            | `src/whatsapp/` (2 files in src) + `extensions/whatsapp/`                                                                                                                                                                                                                                   | Minimal in src; extension has channel + runtime                                                                                                                                                                                                                                                                                                                                                            |
| **Gateway**                             | `src/gateway/` (195 files)                                                                                                                                                                                                                                                                  | Joey Control Center — requests, routing, API                                                                                                                                                                                                                                                                                                                                                               |
| **Agents runtime**                      | `src/agents/` (461 files)                                                                                                                                                                                                                                                                   | Execution engine, tools, skills loader, sandbox, pi-embedded-runner, auth-profiles, lanes, session, workspace                                                                                                                                                                                                                                                                                              |
| **Infra**                               | `src/infra/` (188 files)                                                                                                                                                                                                                                                                    | Retry, backoff, outbound delivery, channel adapters, heartbeat, provider-usage, exec, restart, etc.                                                                                                                                                                                                                                                                                                        |
| **Cron / scheduler**                    | `src/cron/` (**42 files**)                                                                                                                                                                                                                                                                  | schedule, service, jobs, isolated-agent, delivery — base for Event Engine                                                                                                                                                                                                                                                                                                                                  |
| **Channels layer**                      | `src/channels/` (**102 files**)                                                                                                                                                                                                                                                             | Registry, plugins (actions, normalize, onboarding, outbound, status-issues for telegram, discord, slack, imessage, signal, whatsapp)                                                                                                                                                                                                                                                                       |
| **Config / CLI / commands**             | `src/config/` (134), `src/cli/` (171), `src/commands/` (231)                                                                                                                                                                                                                                | Full config, CLI, commands                                                                                                                                                                                                                                                                                                                                                                                 |
| **Logging**                             | `src/logging/` (15 files)                                                                                                                                                                                                                                                                   | Logging framework (add trade/AI logs later)                                                                                                                                                                                                                                                                                                                                                                |
| **Media**                               | `src/media/` (19), `src/media-understanding/` (37)                                                                                                                                                                                                                                          | Fetch, store, image-ops — keep for trading links/images                                                                                                                                                                                                                                                                                                                                                    |
| **Security / sessions / routing**       | `src/security/` (13), `src/sessions/` (7), `src/routing/` (5)                                                                                                                                                                                                                               | In place                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Daily brief**                         | `src/openjoey/daily-brief.ts`, `scripts/run-daily-brief.ts`, `scripts/run-daily-brief-cron.sh`                                                                                                                                                                                              | Market snapshot (CoinGecko), **trade news from RSS** (Fed, crypto, gold, markets), build per user, HTML delivery; cron wrapper for env                                                                                                                                                                                                                                                                     |
| **Trade news RSS**                      | `src/openjoey/trade-news-feeds.ts`, `scripts/fetch-trade-news.ts`, `skills/trade-news-feeds/`                                                                                                                                                                                               | Parallel RSS fetch (8s timeout); daily brief + on-demand “latest Fed/crypto/gold news”; skill for agent to return headlines with links                                                                                                                                                                                                                                                                     |
| **OpenJoey scripts**                    | `scripts/run-daily-brief.ts`, `run-daily-brief-cron.sh`, `fetch-trade-news.ts`, `deploy-hetzner.sh`, `add-daily-brief-cron-hetzner.sh`, `validate-trading-skills.ts`, `openjoey-check-before-push.sh`, `openjoey-sync-upstream.sh`, `add-supabase-to-hetzner.sh`, `add-redis-to-hetzner.sh` | Brief, deploy, cron, trade-news, validation, sync                                                                                                                                                                                                                                                                                                                                                          |
| **Extensions**                          | 14 plugins in `extensions/`                                                                                                                                                                                                                                                                 | **Channel:** telegram, discord, whatsapp. **Other:** copilot-proxy, diagnostics-otel, google-antigravity-auth, google-gemini-cli-auth, llm-task, lobster, memory-core, memory-lancedb, minimax-portal-auth, open-prose, qwen-portal-auth.                                                                                                                                                                  |
| **Trading skills**                      | **36 skill folders** in `skills/`                                                                                                                                                                                                                                                           | alert-guru, central-bank-watch, commodity-guru, correlation-tracker, cot-analyzer, crypto-guru, dex-scanner, economic-calendar, edy, forex-guru, futures-analyzer, insider-tracker, market-scanner, meme-guru, news-alerts, options-guru, options-strategy, penny-stock-scanner, research-guru, sentiment-tracker, signal-guru, stock-guru, trade-news-feeds, trading-god-pro, unusual-options, whale-guru |
| **Dev/ops skills**                      | `skills/healthcheck/`, `skills/coding-agent/`, `skills/github/`, `skills/brave-api-setup/`, `skills/1password/`                                                                                                                                                                             | Keep                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Supporting skills**                   | `skills/discord/`, `skills/wacli/`, `skills/session-logs/`, `skills/skill-creator/`, `skills/clawhub/`                                                                                                                                                                                      | Channel actions, WhatsApp CLI, session search, skill authoring, ClawHub                                                                                                                                                                                                                                                                                                                                    |
| **Supabase**                            | `supabase/migrations/` (4 files)                                                                                                                                                                                                                                                            | 003_user_watchlist_favorites_skill_use, 004_user_referral_milestones, 005_daily_brief_preferences, v2_rls_policies                                                                                                                                                                                                                                                                                         |
| **Also in src (not OpenJoey-specific)** | `src/imessage/` (17), `src/slack/` (65), `src/signal/` (24), `src/line/` (34), `src/browser/` (49), `src/tts/` (2), `src/daemon/`, `src/hooks/`, `src/tui/`, etc.                                                                                                                           | Present; gate or ignore for OpenJoey as needed                                                                                                                                                                                                                                                                                                                                                             |

---

## 2. DELETE (skills — non-trading / lifestyle / voice) — DONE

**Deleted** (24 skill folders removed):

apple-notes, apple-reminders, bear-notes, camsnap, food-order, gog, goplaces, himalaya, imsg, local-places, notion, obsidian, openhue, ordercli, peekaboo, sherpa-onnx-tts, openai-whisper, openai-whisper-api, sonoscli, spotify-player, things-mac, trello, voice-call, weather.

**Evaluate later — verdict (keep vs delete):**

| Skill             | What it does                                                                                          | Verdict                                   |
| ----------------- | ----------------------------------------------------------------------------------------------------- | ----------------------------------------- |
| **edy**           | 5-instrument trading: GBP/USD, Gold, DJ30, GER40, NSDQ100 — morning briefings, TA, entry/exit signals | **KEEP** — core trading                   |
| **discord**       | Discord actions (react, send, stickers, polls, threads) — used with Discord channel                   | **KEEP** — we keep Discord                |
| **wacli**         | WhatsApp send/search/sync (message others, history) — not for normal user chats                       | **KEEP** — we keep WhatsApp               |
| **session-logs**  | Search conversation history (jq on session JSONL) — “what did we discuss”                             | **KEEP** — lightweight, useful            |
| **skill-creator** | How to create/package AgentSkills (SKILL.md, scripts, references)                                     | **KEEP** — meta-skill for building skills |
| **clawhub**       | ClawHub CLI — search, install, update, publish skills from clawhub.com                                | **KEEP** — skill ecosystem                |
| blogwatcher       | Monitor RSS/Atom feeds via blogwatcher CLI                                                            | DELETE — not trading                      |
| summarize         | Summarize URLs, YouTube, files via summarize.sh CLI                                                   | DELETE — not trading                      |
| nano-banana-pro   | Image gen/edit via Gemini 3 Pro Image                                                                 | DELETE — not trading                      |
| nano-pdf          | Edit PDFs with natural-language instructions                                                          | DELETE — not trading                      |
| openai-image-gen  | Batch image gen via OpenAI Images API                                                                 | DELETE — not trading                      |
| video-frames      | Extract frames from video (ffmpeg)                                                                    | DELETE — not trading                      |
| gifgrep           | Search GIFs (Tenor/Giphy), download, stills/sheets                                                    | DELETE — not trading                      |
| canvas            | Display HTML on connected nodes (Mac/iOS/Android)                                                     | DELETE — dev/demo, not trading            |
| model-usage       | CodexBar CLI cost usage per model (Codex/Claude)                                                      | DELETE — dev tool                         |
| slack             | Slack actions (react, pin, send)                                                                      | DELETE — Slack channel removed            |
| eightctl          | Eight Sleep pod control (temp, alarms, schedules)                                                     | DELETE — lifestyle                        |
| blucli            | BluOS/Bluesound playback, volume, grouping                                                            | DELETE — lifestyle                        |
| mcporter          | MCP server CLI — list, call, auth, codegen                                                            | DELETE — dev/integration                  |
| oracle            | Prompt + file bundling for GPT/oracle one-shot (browser/API)                                          | DELETE — dev/code, not trading            |
| sag               | ElevenLabs TTS with local playback                                                                    | DELETE — voice, not core                  |
| songsee           | Spectrograms/feature panels from audio                                                                | DELETE — not trading                      |
| tmux              | Remote-control tmux for interactive CLIs / coding agents                                              | DELETE — dev/infra                        |
| gemini            | Gemini CLI one-shot Q&A                                                                               | DELETE — generic LLM, providers elsewhere |
| bluebubbles       | iMessage via BlueBubbles (send, react, edit)                                                          | DELETE — iMessage channel removed         |

**After evaluation — DONE:** Kept edy, discord, wacli, session-logs, skill-creator, clawhub. Deleted 19 skills (blogwatcher, summarize, nano-banana-pro, nano-pdf, openai-image-gen, video-frames, gifgrep, canvas, model-usage, slack, eightctl, blucli, mcporter, oracle, sag, songsee, tmux, gemini, bluebubbles).

---

## 3. DELETE or GATE (channels — keep only Telegram, WhatsApp, Discord, Web)

**Extensions — DONE.** The listed channel extensions (bluebubbles, feishu, googlechat, imessage, line, matrix, mattermost, msteams, nextcloud-talk, nostr, signal, slack, tlon, twitch, zalo, zalouser, voice-call) have been removed. Only `extensions/telegram/`, `extensions/discord/`, `extensions/whatsapp/` (and other non-channel extensions) remain.

**Keep:**  
`src/telegram/`, `src/discord/`, `src/web/`, `src/whatsapp/` and `extensions/telegram/`, `extensions/discord/`, `extensions/whatsapp/`. Refactor toward one **delivery** layer (message_router + adapters) over time.

**Channel plugins in `src/channels/plugins/`:**  
Keep telegram, discord, whatsapp, web. **Phase 4:** Remove (delete) `src/imessage/`, `src/slack/`, `src/signal/`, `src/line/` and all references — we are not gating. **Voice:** Keep user voice notes (speech-to-text) via `src/media-understanding/`; remove TTS (AI speaking) `src/tts/`. Remove `src/browser/`, `src/canvas-host/`.

---

## 4. KEEP (do not delete)

| Path                                                                                                                                                                                                                                                                 | Role                                              |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- |
| `src/gateway/`                                                                                                                                                                                                                                                       | Joey Control Center                               |
| `src/agents/`                                                                                                                                                                                                                                                        | Agent runtime, tools, skills, sandbox             |
| `src/infra/`                                                                                                                                                                                                                                                         | Workers, retry, rate limit, outbound, heartbeat   |
| `src/cron/`                                                                                                                                                                                                                                                          | Scheduler → Event Engine base                     |
| `src/openjoey/`                                                                                                                                                                                                                                                      | All 25 files — OpenJoey-specific logic            |
| `src/telegram/`                                                                                                                                                                                                                                                      | Telegram delivery                                 |
| `src/discord/`                                                                                                                                                                                                                                                       | Discord delivery                                  |
| `src/web/`                                                                                                                                                                                                                                                           | Web dashboard                                     |
| `src/whatsapp/`                                                                                                                                                                                                                                                      | WhatsApp (minimal in src)                         |
| `src/channels/`                                                                                                                                                                                                                                                      | Registry + plugins (trim which channels load)     |
| `src/config/`, `src/cli/`, `src/commands/`                                                                                                                                                                                                                           | Config, CLI, commands                             |
| `src/logging/`                                                                                                                                                                                                                                                       | Logging                                           |
| `src/media/`, `src/media-understanding/`                                                                                                                                                                                                                             | Media for links/images                            |
| `src/security/`, `src/sessions/`, `src/routing/`                                                                                                                                                                                                                     | Security, sessions, routing                       |
| `src/process/`, `src/plugins/`, `src/providers/`                                                                                                                                                                                                                     | Process, plugins, providers                       |
| `src/markdown/`, `src/terminal/`, `src/utils/`, `src/types/`                                                                                                                                                                                                         | Shared utilities                                  |
| `supabase/migrations/`                                                                                                                                                                                                                                               | All migrations                                    |
| `scripts/run-daily-brief.ts`, `scripts/run-daily-brief-cron.sh`, `scripts/fetch-trade-news.ts`, `scripts/deploy-hetzner.sh`, `scripts/add-daily-brief-cron-hetzner.sh`, `scripts/validate-trading-skills.ts`, `scripts/openjoey-*.sh`, `scripts/add-*-to-hetzner.sh` | Brief, trade-news, deploy, cron, validation, sync |
| All **trading & dev/ops skills** listed in execution plan “Keep”                                                                                                                                                                                                     | alert-guru, crypto-guru, whale-guru, etc.         |

---

## 5. UPDATE (refactor / convert)

| Item                | Current                                             | Target                                                                                                                                                                                                          |
| ------------------- | --------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Delivery**        | Telegram/Discord/Web/WhatsApp each wired separately | Introduce **message_router** + **adapters**; flow: Agent → Signal → Router → Platform Adapter. Can start by a thin router in `src/openjoey/delivery/` that delegates to existing telegram/discord/web/whatsapp. |
| **Cron**            | `src/cron/` — generic jobs, isolated-agent          | **Event Engine** — add/surface jobs for: daily brief (done), pre-market, whale snapshots, hourly scans, unlock alerts, CPI/FOMC.                                                                                |
| **Channels config** | All channels loadable                               | OpenJoey build/config: **only** Telegram, WhatsApp, Discord, Web enabled; others excluded or gated.                                                                                                             |
| **Logging**         | General logging                                     | **Add:** trade decision logs, AI reasoning logs, token safety logs (new sinks or modules under `src/logging/` or openjoey).                                                                                     |
| **Browser**         | Full Playwright/browser control                     | **Restrict** to scraping-only use (no user session takeover); gate or remove UI automation for OpenJoey.                                                                                                        |

---

## 6. ADD (missing from codebase)

| #   | Path / component                                                  | Purpose                                                                                                                                                                                                                      |
| --- | ----------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1   | `src/openjoey/delivery/`                                          | message_router, telegram_adapter, whatsapp_adapter, discord_adapter, web_dashboard — single gateway layer. Can wrap existing src/telegram, src/discord, src/web, src/whatsapp.                                               |
| 2   | `src/openjoey/internal_bus/`                                      | job_queue, result_queue, event_stream — agents pull jobs by domain, push results.                                                                                                                                            |
| 3   | `src/openjoey/agents/` (fixed roster)                             | master_coordinator, news_agent, alert_agent, meme_agent, blockchain_agent, forex_agent, data_agent, whale_agent, token_safety_agent, liquidity_agent, sentiment_agent, … (long-lived agents that consume from internal_bus). |
| 4   | `src/openjoey/agents/devops_ai/`                                  | code_health, api_monitor, model_performance, exchange_status — read-only, alert via Telegram.                                                                                                                                |
| 5   | `src/openjoey/data_harvester/`                                    | scrapers/, free_api_clients/, data_normalizer/, cache_layer/, rate_limiter — low-cost data (today only daily-brief uses CoinGecko in openjoey).                                                                              |
| 6   | `src/openjoey/data/connectors/` (or `data_harvester/connectors/`) | dexscreener, birdeye, coingecko, jupiter, binance, solana rpc, forex api, commodity feeds — concrete clients.                                                                                                                |
| 7   | `src/openjoey/analysis/`                                          | token safety scoring, whale patterns, sentiment, volume anomaly, rug probability — analysis used by agents.                                                                                                                  |
| 8   | **Agent pool limits** (config or small module)                    | Max workers per agent type, job priority — optional but recommended.                                                                                                                                                         |
| 9   | **Ops Guardian / Code Guardian**                                  | API health, codebase observer, queue monitor — detect failures and alert (e.g. Telegram) before users complain.                                                                                                              |

---

## 7. Summary counts

| Action                          | Status                                                                                                                                                                                                                                                                      |
| ------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **DELETE (skills)**             | **Done** — 24 non-trading + 19 evaluate-later + **Phase 4:** 1password, coding-agent, github = 46 skill folders removed total                                                                                                                                               |
| **DELETE (channel extensions)** | **Done** — bluebubbles, feishu, googlechat, imessage, line, matrix, mattermost, msteams, nextcloud-talk, nostr, signal, slack, tlon, twitch, voice-call, zalo, zalouser removed                                                                                             |
| **GATE (core channels)**        | **Phase 4 — Done** — When OpenJoey channel filter is active, only telegram, discord, web, whatsapp accepted at core (`OPENJOEY_ALLOWED_CHANNELS` in `src/openjoey/config.ts`). src/imessage, slack, signal, line remain in repo but cannot be loaded when allowlist is set. |
| **KEEP**                        | Gateway, agents, infra, cron, openjoey, telegram, discord, web, whatsapp, channels, config, cli, commands, logging, media, security, sessions, routing, trading skills, deploy/brief scripts, Supabase                                                                      |
| **UPDATE**                      | Delivery (add router), Cron (event engine), channel config (OpenJoey-only), logging (trade/AI logs)                                                                                                                                                                         |
| **ADD**                         | delivery/, internal_bus/, agents/ (fixed roster), data_harvester/, data/connectors/, analysis/, devops_ai agents, Ops/Code Guardian, agent pool limits                                                                                                                      |

---

_Scan: deep codebase scan; file counts and paths as of scan date. Re-scan after major deletions or additions._
